<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <title>NFCReader</title>
        <!--link rel="stylesheet" href="style.css"-->
        <!--script src="script.js"></script-->
    </head>
    <body>
        <!-- page content -->
        <h1>NFC Reader</h1>
        <div>
            <p>To read the M24LR04E-R RFID tag.</p>
            <button id="scanButton">Query NFC</button>
            <p id="log">Logger...</p>
        </div>
    </body>
    <script>
        if ('NDEFReader' in window) {

            navigator.permissions.query({ name: "nfc" }).then((nfcStatus) => {

                if (nfcStatus.state === "granted") {
                    startScanning();
                } else {

                document.querySelector("#scanButton").onclick = event => {
                    startScanning();
                };

                }

            });

            function startScanning(){
                const ndef = new NDEFReader();

                ndef.scan().then(() => {

                ndef.onreadingerror = () => {
                    // Could not scan a tag, try another
                    document.getElementById("log").innerHTML = "Tag read error !";
                };

                ndef.onreading = event => {
                    //Scanned a tag successfully
                    document.getElementById("log").innerHTML = "Scanned successfully !";
                };

                }).catch(error => {
                /// Something wrong with hardware
                document.getElementById("log").innerHTML = "Hardware error !";
                });
            }
        }
    </script>
</html> 
